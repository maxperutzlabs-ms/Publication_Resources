# Publication resource repository: 2023_hollenstein_chemical-ligand-acetylation

**Chemical acetylation of ligands and two-step digestion protocol for reducing co-digestion in affinity purification-mass spectrometry**
<br>
*David M. Hollenstein, Margarita Maurer-Granofszky, Wolfgang Reiter, Dorothea Anrather, Thomas Gossenreiter, Riccardo Babic, Natascha Hartl, Claudine Kraft, Markus Hartl*

This repository provides the complete source code that was used for downstream processing of the mass spectrometry data used in this study and for creating the plots and tables shown in the publication. Please refer to the sections below for detailed instructions on how to reproduce the data analysis from the publication.

The repository inlcudes several folders with the following content: 

- **database**: Contains FASTA files used for peptide spectrum matching with FragPipe (needs to be downloaded from PRIDE).
- **distributions**: Contains distribution files for the `xlsxreport` and `msreport` python libraries.
- **manuscript_analysis**: Contains Jupyter notebooks used to generate the plots shown in the manuscript.
- **ms_data**: Contains `RAW` files and FragPipe output folders (needs to be downloaded from PRIDE).
- **msreport_analysis**: Contains Jupyter notebooks used for the downstream processing of the FragPipe output.
- **plots**: Output folder for files generated by the Jupyter notebooks from the *manuscript_analysis* folder.
- **python_scripts**: Contains an additional Python module used to generate TIC plots.
- **qtable_data**: Contains files exported during the downstream processing of the FragPipe output. These files are used for further analysis and for generating the plots shown in the manuscript.


## Getting started
To prepare the local repository, follow these steps:
1) Clone the repository from GitHub into a local folder that is accessible by JupyterLab (by default somewhere in your user directory).
   ```shell
   git clone https://github.com/maxperutzlabs-ms/Publication_Resources
   ```
1) Navigate to the *2023_hollenstein_chemical-ligand-acetylation* folder.
1) Download the five zipped FragPipe `SEARCH` folders from the [PRIDE repository](https://www.ebi.ac.uk/pride/archive/projects/PXD043709) and extract them into the *ms_data* folder.
1) Download the two FASTA files from the [PRIDE repository](https://www.ebi.ac.uk/pride/archive/projects/PXD043709) and place them into the *database* folder.
1) *Optional, only required for generating the TIC and base peak plots.*
    - Download the `RAW` files from the [PRIDE repository](https://www.ebi.ac.uk/pride/archive/projects/PXD043709) and copy them into the respective subfolder in the *ms_data* folder. Information about which `RAW` files belong to which FragPipe folder can be found in the *rawfile_annotation.xlsx* table in the PRIDE repository.
    - Download and install [ProteoWizard](https://proteowizard.sourceforge.io/).
    - Use MsConvert from ProteoWizard to convert the `RAW` files to `mzML` (Enable peak picking enabled on MS1 and MS2 level with the “Prefer Vendor” option).


## Environment setup
To set up the Python and R environments, follow these instructions:

1) Install Python version 3.9 (we recommend installing Python into a fresh virtual environment).
1) Install the required Python libraries using pip and the provided requirements.txt file.
   ```shell
   pip install -r ./requirements.txt
   ```
1) Install the `xlsxreport` and `msreport` python libraries using the files from the *distributions* directory.
   ```shell
   pip install ./distributions/xlsxreport-0.0.6-py3-none-any.whl
   pip install ./distributions/msreport-0.0.13-py3-none-any.whl
   ```
1) Setup a local xlsxreport app folder by running the following script in your terminal.
   ```shell
   xlsxreport_setup
   ```
1) Install JupyterLab by following the installation instructions from the [JupyterLab website](https://jupyterlab.readthedocs.io/en/stable/getting_started/installation.html).
1) Install R version 4.2.1 and the [LIMMA](https://bioconductor.org/packages/release/bioc/html/limma.html) package version 3.54.2 .
    - *Note that it might be necessary to define the `R_HOME` system environment variable for running the Jupyter notebooks.*


## Downstream processing of FragPipe output with msreport
1) Launch JupyterLab by executing the `jupyter lab` command in your terminal.
1) Once JupyterLab is running, navigate to the *msreport_analysis* folder within JupyterLab's file browser.
1) Execute the code from the Jupyter notebooks located in the *msreport_analysis* folder. The order of execution does not matter.
    - Running these notebooks creates the protein and peptide tables that are used in the Jupyter notebooks from the *manuscript_analysis* folder and saves them into the *qtable_data* folder.
    - The *qtable_data* already contains those output files, running the Jupyter notebooks simply overrides them.


## Data analysis and visualization used for the manuscript
1) Launch JupyterLab by executing the `jupyter lab` command in your terminal.
1) Once JupyterLab is running, navigate to the *manuscript_analysis* folder within JupyterLab's file browser.
1) Execute the code from the Jupyter notebooks located in the *manuscript_analysis* folder.
    - Running these notebooks generates the plots shown in the manuscript and saves them into the *plots* folder.
    - The *plots* folder already contains the graphics used in the manuscript, running the Jupyter notebooks simply overrides them.
